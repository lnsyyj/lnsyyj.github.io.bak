---
title: '[LinuxCast]Linux网络基础配置 - 笔记'
date: 2019-08-28 10:54:52
tags: linux网络
---

# 以太网连接

- 在Linux中，以太网接口被命名为：eth0、eth1等，0、1代表网卡编号。

- 通过lspci命令可以查看网卡硬件信息（如果是usb网卡，则可能需要使用lsusb命令）

- 命令ifconfig命令用来查看接口信息

  `ifconfig -a`		 查看所有接口

  `ifconfig eth0`	查看特定接口

- 命令ifup、ifdown用来启用、禁用一个接口

  `ifup eth0`

  `ifdown eht0`

```
[root@aio1 ~]# ifconfig ens33
ens33: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 9000
        inet 192.168.46.200  netmask 255.255.255.0  broadcast 192.168.46.255
        inet6 fe80::b3f5:7411:df98:1d00  prefixlen 64  scopeid 0x20<link>
        ether 00:0c:29:1d:7b:de  txqueuelen 1000  (Ethernet)
        RX packets 16673  bytes 23150661 (22.0 MiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 2645  bytes 223690 (218.4 KiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

RX packets 接收包数量
TX packets 发送包数量
```

# 网络相关配置文件

- 网卡配置文件

  /etc/sysconfig/network-scripts/ifcfg-ens8f0

  ```
  TYPE=Ethernet									# 类型=以太网
  PROXY_METHOD=none								# 
  BROWSER_ONLY=no									# 
  BOOTPROTO=none									# 启动协议
  DEFROUTE=yes									# 
  IPV4_FAILURE_FATAL=no							# 
  IPV6INIT=yes									# 
  IPV6_AUTOCONF=yes								# 
  IPV6_DEFROUTE=yes								# 
  IPV6_FAILURE_FATAL=no							# 
  IPV6_ADDR_GEN_MODE=stable-privacy				# 
  NAME=ens33										# 
  UUID=3434b388-c4db-4130-bf90-3e34115fe2d3		# UUID，统一标识符
  DEVICE=ens33									# 设备名称
  ONBOOT=yes										# 服务器启动时，自动启用
  
  IPADDR=192.168.46.200							# IP地址
  NETMASK=255.255.255.0							# 子网掩码
  GATEWAY=192.168.46.2							# 网关
  DNS1=192.168.46.2								# DNS
  ```

- DNS配置文件

  /etc/resolv.conf

  ```
  # Generated by NetworkManager
  search localdomain
  nameserver 192.168.46.2
  ```

- 主机名配置文件

  /etc/sysconfig/network

- 静态主机名配置文件

  /etc/hosts

# 网络测试命令

- 测试网络连通性

  ping 192.168.1.1

  ping www.baidu.com

- 测试DNS解析

  ```
  yum install -y bind-utils
  ```

  host www.baidu.com

  ```
  域名到IP地址的解析
  [root@dev ~]# host www.baidu.com
  www.baidu.com is an alias for www.a.shifen.com.
  www.a.shifen.com has address 61.135.169.125
  www.a.shifen.com has address 61.135.169.121
  ```

  dig www.baidu.com

- 显示路由表

  ip route

  ```
  [root@aio1 ~]# ip route
  default via 192.168.46.2 dev ens33 proto static metric 100 #跟我不在一个网段的，发给default
  default via 192.168.46.2 dev ens34 proto static metric 101 
  default via 192.168.46.2 dev ens35 proto static metric 102 
  default via 192.168.46.2 dev ens36 proto dhcp metric 103 
  172.29.232.0/22 dev br-dbaas proto kernel scope link src 172.29.232.100 
  192.168.46.0/24 dev ens33 proto kernel scope link src 192.168.46.200 metric 100 
  192.168.46.0/24 dev ens36 proto kernel scope link src 192.168.46.137 metric 103 
  192.168.46.2 dev ens34 proto static scope link metric 101 
  192.168.46.2 dev ens35 proto static scope link metric 102 
  192.168.100.0/24 dev ens34 proto kernel scope link src 192.168.100.200 metric 101 
  192.168.200.0/24 dev ens35 proto kernel scope link src 192.168.200.200 metric 102 
  ```

- 追踪到达目标地址的网络路径

  ```
  yum install -y traceroute
  ```

  traceroute www.baidu.com

- 使用mtr进行网络质量测试（结合了traceroute和ping）

  ```
  yum install -y mtr
  ```

  mtr www.baidu.com

# 修改主机名

- 实时修改主机名

  ```
  hostname train.linuxcast.net
  ```

- 永久性修改主机名

  ```
  /etc/sysconfig/network
  
  HOSTNAME=train.linuxcast.net
  ```

# 故障排查

网络故障排查遵循从底层到高层、从自身到外部的流程进行

- 先查看网络配置信息是否正确

  IP地址

  子网掩码

  网关

  DNS

- 查看到达网关是否连通

  ping 网关IP地址

- 查看DNS解析是否正常

  ```
  host www.baidu.com
  ```

- traceroute www.baidu.com